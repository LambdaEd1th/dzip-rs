# dzip-cli

**dzip-cli** is the command-line frontend for the `dzip-rs` project. It provides a terminal interface to unpack, list, and pack **Marmalade SDK** resource archives (`.dz` / `.dzip`) with high performance and precision.

## ðŸ“¦ Installation

### From Source

If you have the repository cloned, you can install the binary directly to your Cargo path:

```bash
# Run from the root of the repo
cargo install --path crates/cli

```

Or build a release binary manually:

```bash
cargo build --release --bin dzip-cli
# Binary will be at: ./target/release/dzip-cli

```

## ðŸš€ Usage

The general syntax is:

```bash
dzip-cli [OPTIONS] <COMMAND>

```

### Global Options

* `-v, --verbose`: Enable debug-level logging for detailed output.

> **Note:** Progress bars are displayed by default but may be hidden if verbose logging is enabled or if the output is not a TTY.

---

### 1. Unpack

Extracts the contents of an archive and generates a TOML configuration file required for repacking.

```bash
dzip-cli unpack [OPTIONS] <INPUT>

```

**Arguments:**

* `<INPUT>`: Path to the `.dz` or `.dzip` file.
* `--output <DIR>` (Optional): Specify a custom output directory. Defaults to a folder named after the input file.
* `--keep-raw` (Optional): If decompression fails (e.g., encrypted or unsupported formats), save the raw compressed bytes instead of aborting.

**Example:**

```bash
# Extract 'assets.dz' to './assets/' and generate 'assets.toml'
dzip-cli unpack assets.dz

# Extract to a specific folder
dzip-cli unpack assets.dz --output ./my_mod_folder

```

### 2. Pack

Creates a new `.dz` archive based on a manifest file.

```bash
dzip-cli pack <CONFIG>

```

**Arguments:**

* `<CONFIG>`: Path to the `.toml` configuration file (usually generated by the `unpack` command).

> **Important:** The packer expects the source files to be in a directory matching the configuration filename. For example, if you pack `data.toml`, the tool looks for files in the `data/` folder relative to the TOML file.

**Example:**

```bash
# Reads 'assets.toml' and packs contents from 'assets/' folder
dzip-cli pack assets.toml

```

### 3. List

Prints a table of contents for an archive without extracting it. Useful for quick inspection.

```bash
dzip-cli list <INPUT>

```

**Arguments:**

* `<INPUT>`: Path to the archive file.

**Example output:**

```text
Size (Bytes)    | Chunks   | Path
----------------|----------|--------------------------------
65536           | 2        | textures/background.png
1024            | 1        | data/config.json

Total files: 2

```

## ðŸ”„ Workflow Example (Modding)

1. **Inspect** the archive to see what's inside:
```bash
dzip-cli list game_data.dz

```


2. **Unpack** the archive:
```bash
dzip-cli unpack game_data.dz

```


*This creates a folder `game_data/` and a file `game_data.toml`.*
3. **Modify** the files inside the `game_data/` folder (replace textures, edit scripts, etc.).
4. **Repack** the modified assets:
```bash
dzip-cli pack game_data.toml

```


*This generates `game_data_packed.dz`.*

## ðŸ“„ License

This project is licensed under the **GNU General Public License v3.0**.